(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{541:function(t,a,s){"use strict";s.r(a);var e=s(4),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"import和library"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#import和library"}},[t._v("#")]),t._v(" import和library")]),t._v(" "),s("p",[t._v("使用"),s("code",[t._v("import")]),t._v("和"),s("code",[t._v("library")]),t._v("指令可以帮助你创建模块化和可共享的代码库。库不只能提供APIs，而且是一个隐私单元：在标识符前面加上一个下划线标志只在该库中可见。"),s("code",[t._v("所有的Dart应用都是一个库")]),t._v("，即使没有"),s("code",[t._v("library")]),t._v("指令。"),s("br"),t._v("\n库可以用"),s("a",{attrs:{href:"https://dart.dev/guides/packages",target:"_blank",rel:"noopener noreferrer"}},[t._v("包(package)"),s("OutboundLink")],1),t._v("来分发。")]),t._v(" "),s("h2",{attrs:{id:"使用库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用库"}},[t._v("#")]),t._v(" 使用库")]),t._v(" "),s("p",[t._v("用"),s("code",[t._v("import")]),t._v("来指定如何在另一个库的范围内使用来自一个库的名称空间。")]),t._v(" "),s("p",[t._v("例如，Dart的web应用通常使用"),s("a",{attrs:{href:"https://api.dart.dev/stable/dart-html",target:"_blank",rel:"noopener noreferrer"}},[t._v("dart:html"),s("OutboundLink")],1),t._v("库，则需要这样导入：")]),t._v(" "),s("div",{staticClass:"language-Dart extra-class"},[s("pre",{pre:!0,attrs:{class:"language-dart"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dart:html'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[s("code",[t._v("import")]),t._v("只需要指定一个指向库的URI参数。对于Dart内置的库有特殊的URI:"),s("code",[t._v("dart:scheme")]),t._v("。对于其他的库，可以使用文件系统路径或者"),s("code",[t._v("package:scheme")]),t._v("。"),s("code",[t._v("package:scheme")]),t._v("方式指定了由包管理器（像是pub tool）提供的库。例如：")]),t._v(" "),s("div",{staticClass:"language-Dart extra-class"},[s("pre",{pre:!0,attrs:{class:"language-dart"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'package:test/test.dart'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"title"},[t._v("Note")]),s("p",[t._v("URI代表统一资源标识符。URLs（uniform resource locators）是一种常用的URI")])]),s("h3",{attrs:{id:"指定库前缀"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#指定库前缀"}},[t._v("#")]),t._v(" 指定库前缀")]),t._v(" "),s("p",[t._v("如果导入了两个标识符冲突的库，这时你可以指定其中一个或者全部的前缀，例如库1和库2中都有Element类，在代码中可以这样写：")]),t._v(" "),s("div",{staticClass:"language-Dart extra-class"},[s("pre",{pre:!0,attrs:{class:"language-dart"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'package:lib1/lib1.dart'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'package:lib2/lib2.dart'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("as")]),t._v(" lib2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用 lib1 中的 Element.")]),t._v("\nElement element1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Element")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用 lib2 中的 Element.")]),t._v("\nlib2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Element element2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" lib2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Element")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"只导入库的部分内容"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#只导入库的部分内容"}},[t._v("#")]),t._v(" 只导入库的部分内容")]),t._v(" "),s("p",[t._v("如果直想使用一个库的一部分，你可以有选择地导入库，例如：")]),t._v(" "),s("div",{staticClass:"language-Dart extra-class"},[s("pre",{pre:!0,attrs:{class:"language-dart"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 只导入foo.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'package:lib1/lib1.dart'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("show")]),t._v(" foo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 导入除了foo之外的所有.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'package:lib2/lib2.dart'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("hide")]),t._v(" foo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"懒加载库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#懒加载库"}},[t._v("#")]),t._v(" 懒加载库")]),t._v(" "),s("p",[s("em",[t._v("延迟加载")]),t._v("（也叫做"),s("em",[t._v("懒加载")]),t._v("）允许web应用按需加载库，仅当这个库被需要时才会加载。遇到以下情况时你可能需要延迟加载：")]),t._v(" "),s("ul",[s("li",[t._v("减少一个web应用的初始化启动时间")]),t._v(" "),s("li",[t._v("执行一个A/B测试-例如尝试一个替代算法的实现")]),t._v(" "),s("li",[t._v("加载很少用到的功能，比如选择页面或者对话框")])]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"title"},[t._v("只有dart2js支持懒加载")]),s("p",[t._v("Flutter、Dart VM和dartdevc都不支持懒加载。更多信息查看"),s("a",{attrs:{href:"https://github.com/dart-lang/sdk/issues/33118",target:"_blank",rel:"noopener noreferrer"}},[t._v("issue #33118"),s("OutboundLink")],1),t._v("和"),s("a",{attrs:{href:"https://github.com/dart-lang/sdk/issues/27776",target:"_blank",rel:"noopener noreferrer"}},[t._v("issue #27776"),s("OutboundLink")],1),t._v("。")])]),s("p",[t._v("要懒加载一个库，要先用"),s("code",[t._v("deferred as")]),t._v("导入库：")]),t._v(" "),s("div",{staticClass:"language-Dart extra-class"},[s("pre",{pre:!0,attrs:{class:"language-dart"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'package:greetings/hello.dart'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("deferred")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("as")]),t._v(" hello"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("当需要使用库时，使用库的标识符调用"),s("code",[t._v("loadLibrary()")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language-Dart extra-class"},[s("pre",{pre:!0,attrs:{class:"language-dart"}},[s("code",[t._v("Future "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("greet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" hello"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("loadLibrary")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  hello"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printGreeting")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("在上面的代码中，"),s("code",[t._v("await")]),t._v("关键词会暂停代码执行直到库加载完毕。更多"),s("code",[t._v("async")]),t._v("和"),s("code",[t._v("await")]),t._v("的信息请参阅"),s("a",{attrs:{href:"https://dart.dev/guides/language/language-tour#asynchrony-support",target:"_blank",rel:"noopener noreferrer"}},[t._v("异步支持"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("p",[t._v("当你使用懒加载的时候需要注意以下几点：")]),t._v(" "),s("ul",[s("li",[t._v("一个懒加载库中的常量在导入文件中不是常量，直到这个库被加载之前，这些常量都不存在。")]),t._v(" "),s("li",[t._v("在导入文件中你不可以使用懒加载库中的类型，取而代之地考虑将接口类型定义到另一个库中同时导入到懒加载和当前应用中。")]),t._v(" "),s("li",[t._v("Dart隐式地在用"),s("code",[t._v("deferred as namespace")]),t._v("的命名空间中插入了"),s("code",[t._v("loadLibrary()")]),t._v("，"),s("code",[t._v("loadLibrary()")]),t._v("函数会返回一个"),s("a",{attrs:{href:"https://dart.dev/guides/libraries/library-tour#future",target:"_blank",rel:"noopener noreferrer"}},[t._v("Future"),s("OutboundLink")],1),t._v("。")])]),t._v(" "),s("h2",{attrs:{id:"实现库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实现库"}},[t._v("#")]),t._v(" 实现库")]),t._v(" "),s("p",[t._v("参考"),s("a",{attrs:{href:"https://dart.dev/guides/libraries/create-library-packages",target:"_blank",rel:"noopener noreferrer"}},[t._v("创建包库"),s("OutboundLink")],1),t._v("来查看实现一个库的相关建议，包括：")]),t._v(" "),s("ul",[s("li",[t._v("如何组织库的源代码")]),t._v(" "),s("li",[t._v("如何使用"),s("code",[t._v("export")]),t._v("指令")]),t._v(" "),s("li",[t._v("如何使用"),s("code",[t._v("part")]),t._v("指令")]),t._v(" "),s("li",[t._v("如何使用"),s("code",[t._v("library")]),t._v("指令")])])])}),[],!1,null,null,null);a.default=r.exports}}]);